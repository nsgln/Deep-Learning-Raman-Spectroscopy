%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% University Assignment Title Page 
% LaTeX Template
% Version 1.0 (27/12/12)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% Original author:
% WikiBooks (http://en.wikibooks.org/wiki/LaTeX/Title_Creation)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
% 
% Instructions for using this template:
% This title page is capable of being compiled as is. This is not useful for 
% including it in another document. To do this, you have two options: 
%
% 1) Copy/paste everything between \begin{document} and \end{document} 
% starting at \begin{titlepage} and paste this into another LaTeX file where you 
% want your title page.
% OR
% 2) Remove everything outside the \begin{titlepage} and \end{titlepage} and 
% move this file to the same directory as the LaTeX file you wish to add it to. 
% Then add \input{./title_page_1.tex} to your LaTeX file where you want your
% title page.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\title{Title page with logo}
%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[12pt]{article}
\usepackage[english]{babel}
\usepackage[utf8x]{inputenc}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage[colorinlistoftodos]{todonotes}

%Added packages
\usepackage{multirow}
\usepackage[flushleft]{threeparttable}

\begin{document}

\begin{titlepage}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % Defines a new command for the horizontal lines, change thickness here

\center % Center everything on the page
 
%----------------------------------------------------------------------------------------
%	HEADING SECTIONS
%----------------------------------------------------------------------------------------

\textsc{\LARGE Universit√† degli studi di Milano-Bicocca}\\[1cm] % Name of your university/college
\textsc{\Large Advanced Machine Learning }\\[0.3cm] % Major heading such as course name
\textsc{\large Final Project}\\[0.1cm] % Minor heading such as course title

%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\HRule \\[0.4cm]
{ \huge \bfseries Deep Learning-Enabled Decoding of Raman Spectroscopy}\\[0.2cm] % Title of your document
\HRule \\[1cm]
 
%----------------------------------------------------------------------------------------
%	AUTHOR SECTION
%----------------------------------------------------------------------------------------

\large
\emph{Authors:}\\
Nina Singlan - 867646- n.singlan@campus.unimib.it \\   % Your name
Romain Michelucci - 867644- r.michelucci@campus.unimib.it   \\[1cm] % Your name

% If you don't want a supervisor, uncomment the two lines below and remove the section above
%\Large \emph{Author:}\\
%John \textsc{Smith}\\[3cm] % Your name

%----------------------------------------------------------------------------------------
%	DATE SECTION
%----------------------------------------------------------------------------------------

{\large \today}\\[1cm] % Date, change the \today to a set date if you want to be precise

%----------------------------------------------------------------------------------------
%	LOGO SECTION
%----------------------------------------------------------------------------------------

\includegraphics{logo.png}\\[1cm] % Include a department/university logo - this will require the graphicx package
 
%----------------------------------------------------------------------------------------

\vfill % Fill the rest of the page with whitespace

\end{titlepage}


\begin{abstract}
%The ABSTRACT is not a part of the body of the report itself. Rather, the abstract is a brief summary of the report contents that is often separately circulated so potential readers can decide whether to read the report. The abstract should very concisely summarize the whole report: why it was written, what was discovered or developed, and what is claimed to be the significance of the effort. The abstract does not include figures or tables, and only the most significant numerical values or results should be given.

Deep learning methods are used on many applications in Raman spectroscopy, especially for the identification of chemical species. Our case study is the classification of patients affected by Amyotrophic Lateral Sclerosis (ALS) and healthy ones (CTRL). Convolutional neural networks (CNNs) are trained to automatically extract features from a Raman spectrum without the need for preprocessing. However, the dataset used is small and unbalanced. Transfer Learning (TL) techniques appear as a good solution to this problem. Using pretrained models on bacterial Raman spectra, our goal is to increase performances (the overall accuracy while reducing its standard deviation?). Data augmentation methods are also involved trying to remedy this problem.
\end{abstract}


\section{Introduction}
%The introduction should provide a clear statement of the problem posed by the project, and why the problem is of interest. It should reflect the scenario, if available. If needed, the introduction also needs to present background information so that the reader can understand the significance of the problem. A brief summary of the hypotheses and the approach your group used to solve the problem should be given, possibly also including a concise introduction to theory or concepts used later to analyze and to discuss the results.
Raman spectroscopy has the potential to identify substances and species of bacteria in a wide range of domains from life sciences laboratory to planetary exploration. Convolutional neural networks in the context of Raman spectroscopy has shown to outperform other machine learning methods with baseline corrected spectra*. However, CNNs are "data-hungry", they require a massive amount of data in order to extract the right features.
	
The dataset used is composed of 591 spectra, 393 for the ALS patients and 198 for the CTRL ones. Usually, a CNN can be well-trained on a few thousands of sample. In addition to the problem of the overall number of samples and other problem lies in the repartition of the number of samples per group (which is shown in table 1). Therefore, the dataset is small and unbalanced.

Transfer learning aims at improving the performance on a target domain by transferring the knowledge contained in different but related source domains. Due to the fact that the dependence on a large number of target domain data can be reduced, TL has become a popular and promising area in machine learning.

In this work, the effort is focused on trying different transfer learning experiments. The first consists in fine-tuning which consists of unfreezing a pre-trained models and re-training it on the new data. This can potentially achieve meaningful improvements by incrementally adapting the pretrained features to the new data. The second experiment is the most common incarnation of transfer learning : after taking the layers from a pre-trained model, the layers are freezed and some new trainable layers are added on top of the frozen ones. These new layers will learn to turn the old features into predictions on a new dataset.

Finally some data augmentation methods will be applied. It is a wellknown technique for improving robustness and training of neural networks. The idea is to expand the number of training samples by adding some noise and small variations resulting in a more robust training. For spectral data, random offsets, mulitplication and gaussian noises are commonly used.

Therefore comparisons between the different experiences will result in finding the model with the best performances.



\section{Datasets}
%In this section the available data sets must be presented. The term dataset refers to any type of information source, for example web services for geolocation fall into this category. 
%In addition, all necessary data manipulation processes, such as cleaning and enrichment with external sources, must be presented and discussed.

The main dataset provided is composed of spectra belonging to patients affected by Amyotrophic Lateral Sclerosis (ALS) and healthy ones (CTRL).

We also use pretrained models that are trained on an external bacteria dataset.

\begin{table}
\centering
\begin{threeparttable}
\caption{This table represents the repartition of patients and spectra belonging to the ALS and CTRL groups}
\begin{tabular}{ |c|c|c|c|c| }
\hline
\multicolumn{5}{ |c| }{Repartition of spectra and patients in dataset} \\
\hline
Groups & Patient ID & Samples range  & Samples count & Number of samples per group\\ \hline
\multirow{20}{*}{ALS} & ALS01 & 1-60 &  60 & \multirow{20}{*}{393}\\
 & ALS02 & 61-78 & 18 &\\
 & ALS05 & 79-114 & 36 &\\
 & ALS07 & 115-150 & 36 &\\ 
 & ALS08 & 151 -194 & 44 &\\
 & ALS09 & 195-210 & 16 &\\
 & ALS10 & 211-225 & 15 &\\
 & ALS11 & 226-242 & 16\text{*} &\\
 & ALS12 & 243-256 & 14 &\\
 & ALS13 & 257-281 & 25 &\\
 & ALS14 & 282-300 & 19 &\\
 & ALS15 & 301-314 & 14 &\\
 & ALS16 & 315-324 & 10 &\\
 & ALS17 & 325-334 & 10 &\\
 & ALS18 & 335-344 & 10 &\\
 & ALS20 & 345-354 & 10 &\\
 & ALS22 & 355-364 & 10 &\\
 & ALS23 & 365-374 & 10 &\\
 & ALS24 & 375-384 & 10 &\\
 & ALS25 & 385-394 & 10 &\\
 \hline
\multirow{10}{*}{CTRL} & CTRL01 & 1-33 & 33 & \multirow{10}{*}{198}\\
 & CTRL02 & 34-76 & 43 &\\
 & CTRL03 & 77-91 & 15 &\\ 
 & CTRL04 & 92-138 & 47 &\\
 & CTRL05 & 139-149 & 11 &\\
 & CTRL06 & 150-158 & 9 &\\
 & CTRL07 & 159-168 & 10 &\\
 & CTRL08 & 169-178 & 10 &\\
 & CTRL09 & 179-188 & 10 &\\
 & CTRL10 & 189-198 & 10 &\\
 \hline


\end{tabular}
\begin{tablenotes}
      \small
      \item \text{*} The 227th sample is missing. It has probably been removed while processing because it was "too bad".
\end{tablenotes}
\end{threeparttable}
\end{table}



\section{The Methodological Approach}

This is the central and most important section of the report. Its objective must be to show, with linearity and clarity, the steps that have led to the definition of a decision model. The description of the working hypotheses, confirmed or denied, can be found in this section together with the description of the subsequent refining processes of the models. Comparisons between different models (e.g. heuristics vs. optimal models) in terms of quality of solutions, their explainability and execution times are welcome. 

Do not attempt to describe all the code in the system, and do not include large pieces of code in this section, use pseudo-code where necessary. Complete source code should be provided separately (in Appendixes, as separated material or as a link to an on-line repo). Instead pick out and describe just the pieces of code which, for example:
\begin{itemize}
\item are especially critical to the operation of the system;
\item you feel might be of particular interest to the reader for some reason;
\item  illustrate a non-standard or innovative way of implementing an algorithm, data
structure, etc..
\end{itemize}

You should also mention any unforeseen problems you encountered when implementing the
system and how and to what extent you overcame them. Common problems are:
 difficulties involving existing software.


\section{Results and Evaluation}
The Results section is dedicated to presenting the actual results (i.e. measured and calculated quantities), not to discussing their meaning or interpretation. The results should be summarized using appropriate Tables and Figures (graphs or schematics). Every Figure and Table should have a legend that describes concisely what is contained or shown. Figure legends go below the figure, table legends above the table. Throughout the report, but especially in this section, pay attention to reporting numbers with an appropriate number of significant figures. 

\section{Discussion}
The discussion section aims at interpreting the results in light of the project's objectives. The most important goal of this section is to interpret the results so that the reader is informed of the insight or answers that the results provide. This section should also present an evaluation of the particular approach taken by the group. For example: Based on the results, how could the experimental procedure be improved? What additional, future work may be warranted? What recommendations can be drawn?


\section{Conclusions}
Conclusions should summarize the central points made in the Discussion section, reinforcing for the reader the value and implications of the work. If the results were not definitive, specific future work that may be needed can be (briefly) described. The conclusions should never contain ``surprises''. Therefore, any conclusions should be based on observations and data already discussed. It is considered extremely bad form to introduce new data in the conclusions.

\section*{References}

The references section should contain complete citations following standard form.  The references should be numbered and listed in the order they were cited in the body of the report. In the text of the report, a particular reference can be cited by using a numerical number in brackets as \cite{Lee2015} that corresponds to its number in the reference list. \LaTeX provides several styles to format the references

\bibliographystyle{IEEEtran}
\bibliography{references.bib}

\end{document}